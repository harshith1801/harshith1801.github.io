// WebGL Warp Background (Codrops Demo 2, customized)
let renderer, scene, camera, points;

init();
animate();

function init() {
    // Renderer
    renderer = new THREE.WebGLRenderer({ canvas: document.getElementById("scene"), alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(window.devicePixelRatio);

    // Scene & Camera
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(55, window.innerWidth / window.innerHeight, 0.1, 2000);
    camera.position.z = 30;

    // Geometry
    const geometry = new THREE.BufferGeometry();
    const numPoints = 20000;
    const positions = new Float32Array(numPoints * 3);

    for (let i = 0; i < numPoints * 3; i++) {
        positions[i] = (Math.random() - 0.5) * 200;
    }

    geometry.setAttribute("position", new THREE.BufferAttribute(positions, 3));

    // Material (blue theme)
    const material = new THREE.PointsMaterial({
        color: 0x1e3a8a,   // deep blue points
        size: 0.5,
        transparent: true,
        opacity: 0.7
    });

    points = new THREE.Points(geometry, material);
    scene.add(points);

    // Handle resize
    window.addEventListener("resize", onWindowResize, false);
}

function onWindowResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
}

function animate() {
    requestAnimationFrame(animate);

    // Rotate the particle field for "warp drive" look
    points.rotation.x += 0.0007;
    points.rotation.y += 0.0005;

    renderer.render(scene, camera);
}
